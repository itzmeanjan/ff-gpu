#include "ff_p.hpp"

inline constexpr uint64_t STATE_WIDTH = 12;
inline constexpr uint64_t RATE_WIDTH = 8;
inline constexpr uint64_t DIGEST_SIZE = 4;
inline constexpr uint64_t NUM_ROUNDS = 7;
inline constexpr uint64_t MDS[STATE_WIDTH][STATE_WIDTH] = {
    {
        2108866337646019936 % MOD,
        11223275256334781131 % MOD,
        2318414738826783588 % MOD,
        11240468238955543594 % MOD,
        8007389560317667115 % MOD,
        11080831380224887131 % MOD,
        3922954383102346493 % MOD,
        17194066286743901609 % MOD,
        152620255842323114 % MOD,
        7203302445933022224 % MOD,
        17781531460838764471 % MOD,
        2306881200 % MOD,
    },
    {
        3368836954250922620 % MOD,
        5531382716338105518 % MOD,
        7747104620279034727 % MOD,
        14164487169476525880 % MOD,
        4653455932372793639 % MOD,
        5504123103633670518 % MOD,
        3376629427948045767 % MOD,
        1687083899297674997 % MOD,
        8324288417826065247 % MOD,
        17651364087632826504 % MOD,
        15568475755679636039 % MOD,
        4656488262337620150 % MOD,
    },
    {
        2560535215714666606 % MOD,
        10793518538122219186 % MOD,
        408467828146985886 % MOD,
        13894393744319723897 % MOD,
        17856013635663093677 % MOD,
        14510101432365346218 % MOD,
        12175743201430386993 % MOD,
        12012700097100374591 % MOD,
        976880602086740182 % MOD,
        3187015135043748111 % MOD,
        4630899319883688283 % MOD,
        17674195666610532297 % MOD,
    },
    {
        10940635879119829731 % MOD,
        9126204055164541072 % MOD,
        13441880452578323624 % MOD,
        13828699194559433302 % MOD,
        6245685172712904082 % MOD,
        3117562785727957263 % MOD,
        17389107632996288753 % MOD,
        3643151412418457029 % MOD,
        10484080975961167028 % MOD,
        4066673631745731889 % MOD,
        8847974898748751041 % MOD,
        9548808324754121113 % MOD,
    },
    {
        15656099696515372126 % MOD,
        309741777966979967 % MOD,
        16075523529922094036 % MOD,
        5384192144218250710 % MOD,
        15171244241641106028 % MOD,
        6660319859038124593 % MOD,
        6595450094003204814 % MOD,
        15330207556174961057 % MOD,
        2687301105226976975 % MOD,
        15907414358067140389 % MOD,
        2767130804164179683 % MOD,
        8135839249549115549 % MOD,
    },
    {
        14687393836444508153 % MOD,
        8122848807512458890 % MOD,
        16998154830503301252 % MOD,
        2904046703764323264 % MOD,
        11170142989407566484 % MOD,
        5448553946207765015 % MOD,
        9766047029091333225 % MOD,
        3852354853341479440 % MOD,
        14577128274897891003 % MOD,
        11994931371916133447 % MOD,
        8299269445020599466 % MOD,
        2859592328380146288 % MOD,
    },
    {
        4920761474064525703 % MOD,
        13379538658122003618 % MOD,
        3169184545474588182 % MOD,
        15753261541491539618 % MOD,
        622292315133191494 % MOD,
        14052907820095169428 % MOD,
        5159844729950547044 % MOD,
        17439978194716087321 % MOD,
        9945483003842285313 % MOD,
        13647273880020281344 % MOD,
        14750994260825376 % MOD,
        12575187259316461486 % MOD,
    },
    {
        3371852905554824605 % MOD,
        8886257005679683950 % MOD,
        15677115160380392279 % MOD,
        13242906482047961505 % MOD,
        12149996307978507817 % MOD,
        1427861135554592284 % MOD,
        4033726302273030373 % MOD,
        14761176804905342155 % MOD,
        11465247508084706095 % MOD,
        12112647677590318112 % MOD,
        17343938135425110721 % MOD,
        14654483060427620352 % MOD,
    },
    {
        5421794552262605237 % MOD,
        14201164512563303484 % MOD,
        5290621264363227639 % MOD,
        1020180205893205576 % MOD,
        14311345105258400438 % MOD,
        7828111500457301560 % MOD,
        9436759291445548340 % MOD,
        5716067521736967068 % MOD,
        15357555109169671716 % MOD,
        4131452666376493252 % MOD,
        16785275933585465720 % MOD,
        11180136753375315897 % MOD,
    },
    {
        10451661389735482801 % MOD,
        12128852772276583847 % MOD,
        10630876800354432923 % MOD,
        6884824371838330777 % MOD,
        16413552665026570512 % MOD,
        13637837753341196082 % MOD,
        2558124068257217718 % MOD,
        4327919242598628564 % MOD,
        4236040195908057312 % MOD,
        2081029262044280559 % MOD,
        2047510589162918469 % MOD,
        6835491236529222042 % MOD,
    },
    {
        5675273097893923172 % MOD,
        8120839782755215647 % MOD,
        9856415804450870143 % MOD,
        1960632704307471239 % MOD,
        15279057263127523057 % MOD,
        17999325337309257121 % MOD,
        72970456904683065 % MOD,
        8899624805082057509 % MOD,
        16980481565524365258 % MOD,
        6412696708929498357 % MOD,
        13917768671775544479 % MOD,
        5505378218427096880 % MOD,
    },
    {
        10318314766641004576 % MOD,
        17320192463105632563 % MOD,
        11540812969169097044 % MOD,
        7270556942018024148 % MOD,
        4755326086930560682 % MOD,
        2193604418377108959 % MOD,
        11681945506511803967 % MOD,
        8000243866012209465 % MOD,
        6746478642521594042 % MOD,
        12096331252283646217 % MOD,
        13208137848575217268 % MOD,
        5548519654341606996 % MOD,
    }};

extern SYCL_EXTERNAL void apply_permutation(uint64_t *const state);

extern SYCL_EXTERNAL void apply_round(uint64_t *const state,
                                      const uint64_t round);

extern SYCL_EXTERNAL void apply_sbox(uint64_t *const state);

extern SYCL_EXTERNAL void apply_mds(uint64_t *const state);

extern SYCL_EXTERNAL void apply_constants(uint64_t *const state,
                                          const uint64_t *ark);

extern SYCL_EXTERNAL void apply_inv_sbox(uint64_t *const state);
