#include "ff_p.hpp"

inline constexpr uint64_t STATE_WIDTH = 12;
inline constexpr uint64_t RATE_WIDTH = 8;
inline constexpr uint64_t DIGEST_SIZE = 4;
inline constexpr uint64_t NUM_ROUNDS = 7;

extern SYCL_EXTERNAL void apply_permutation(uint64_t *const state);

extern SYCL_EXTERNAL void apply_round(uint64_t *const state,
                                      const uint64_t round);

extern SYCL_EXTERNAL void apply_sbox(uint64_t *const state);

extern SYCL_EXTERNAL void apply_mds(uint64_t *state);

extern SYCL_EXTERNAL void apply_constants(uint64_t *const state,
                                          const uint64_t *ark);

extern SYCL_EXTERNAL void apply_inv_sbox(uint64_t *const state);

extern SYCL_EXTERNAL void exp_acc(const uint64_t m, const uint64_t *base,
                                  const uint64_t *tail, uint64_t *const res);

inline constexpr uint64_t MDS[STATE_WIDTH][STATE_WIDTH] = {
    {
        2108866337646019936 % MOD,
        11223275256334781131 % MOD,
        2318414738826783588 % MOD,
        11240468238955543594 % MOD,
        8007389560317667115 % MOD,
        11080831380224887131 % MOD,
        3922954383102346493 % MOD,
        17194066286743901609 % MOD,
        152620255842323114 % MOD,
        7203302445933022224 % MOD,
        17781531460838764471 % MOD,
        2306881200 % MOD,
    },
    {
        3368836954250922620 % MOD,
        5531382716338105518 % MOD,
        7747104620279034727 % MOD,
        14164487169476525880 % MOD,
        4653455932372793639 % MOD,
        5504123103633670518 % MOD,
        3376629427948045767 % MOD,
        1687083899297674997 % MOD,
        8324288417826065247 % MOD,
        17651364087632826504 % MOD,
        15568475755679636039 % MOD,
        4656488262337620150 % MOD,
    },
    {
        2560535215714666606 % MOD,
        10793518538122219186 % MOD,
        408467828146985886 % MOD,
        13894393744319723897 % MOD,
        17856013635663093677 % MOD,
        14510101432365346218 % MOD,
        12175743201430386993 % MOD,
        12012700097100374591 % MOD,
        976880602086740182 % MOD,
        3187015135043748111 % MOD,
        4630899319883688283 % MOD,
        17674195666610532297 % MOD,
    },
    {
        10940635879119829731 % MOD,
        9126204055164541072 % MOD,
        13441880452578323624 % MOD,
        13828699194559433302 % MOD,
        6245685172712904082 % MOD,
        3117562785727957263 % MOD,
        17389107632996288753 % MOD,
        3643151412418457029 % MOD,
        10484080975961167028 % MOD,
        4066673631745731889 % MOD,
        8847974898748751041 % MOD,
        9548808324754121113 % MOD,
    },
    {
        15656099696515372126 % MOD,
        309741777966979967 % MOD,
        16075523529922094036 % MOD,
        5384192144218250710 % MOD,
        15171244241641106028 % MOD,
        6660319859038124593 % MOD,
        6595450094003204814 % MOD,
        15330207556174961057 % MOD,
        2687301105226976975 % MOD,
        15907414358067140389 % MOD,
        2767130804164179683 % MOD,
        8135839249549115549 % MOD,
    },
    {
        14687393836444508153 % MOD,
        8122848807512458890 % MOD,
        16998154830503301252 % MOD,
        2904046703764323264 % MOD,
        11170142989407566484 % MOD,
        5448553946207765015 % MOD,
        9766047029091333225 % MOD,
        3852354853341479440 % MOD,
        14577128274897891003 % MOD,
        11994931371916133447 % MOD,
        8299269445020599466 % MOD,
        2859592328380146288 % MOD,
    },
    {
        4920761474064525703 % MOD,
        13379538658122003618 % MOD,
        3169184545474588182 % MOD,
        15753261541491539618 % MOD,
        622292315133191494 % MOD,
        14052907820095169428 % MOD,
        5159844729950547044 % MOD,
        17439978194716087321 % MOD,
        9945483003842285313 % MOD,
        13647273880020281344 % MOD,
        14750994260825376 % MOD,
        12575187259316461486 % MOD,
    },
    {
        3371852905554824605 % MOD,
        8886257005679683950 % MOD,
        15677115160380392279 % MOD,
        13242906482047961505 % MOD,
        12149996307978507817 % MOD,
        1427861135554592284 % MOD,
        4033726302273030373 % MOD,
        14761176804905342155 % MOD,
        11465247508084706095 % MOD,
        12112647677590318112 % MOD,
        17343938135425110721 % MOD,
        14654483060427620352 % MOD,
    },
    {
        5421794552262605237 % MOD,
        14201164512563303484 % MOD,
        5290621264363227639 % MOD,
        1020180205893205576 % MOD,
        14311345105258400438 % MOD,
        7828111500457301560 % MOD,
        9436759291445548340 % MOD,
        5716067521736967068 % MOD,
        15357555109169671716 % MOD,
        4131452666376493252 % MOD,
        16785275933585465720 % MOD,
        11180136753375315897 % MOD,
    },
    {
        10451661389735482801 % MOD,
        12128852772276583847 % MOD,
        10630876800354432923 % MOD,
        6884824371838330777 % MOD,
        16413552665026570512 % MOD,
        13637837753341196082 % MOD,
        2558124068257217718 % MOD,
        4327919242598628564 % MOD,
        4236040195908057312 % MOD,
        2081029262044280559 % MOD,
        2047510589162918469 % MOD,
        6835491236529222042 % MOD,
    },
    {
        5675273097893923172 % MOD,
        8120839782755215647 % MOD,
        9856415804450870143 % MOD,
        1960632704307471239 % MOD,
        15279057263127523057 % MOD,
        17999325337309257121 % MOD,
        72970456904683065 % MOD,
        8899624805082057509 % MOD,
        16980481565524365258 % MOD,
        6412696708929498357 % MOD,
        13917768671775544479 % MOD,
        5505378218427096880 % MOD,
    },
    {
        10318314766641004576 % MOD,
        17320192463105632563 % MOD,
        11540812969169097044 % MOD,
        7270556942018024148 % MOD,
        4755326086930560682 % MOD,
        2193604418377108959 % MOD,
        11681945506511803967 % MOD,
        8000243866012209465 % MOD,
        6746478642521594042 % MOD,
        12096331252283646217 % MOD,
        13208137848575217268 % MOD,
        5548519654341606996 % MOD,
    }};

inline constexpr uint64_t ARK1[NUM_ROUNDS][STATE_WIDTH] = {
    {
        13917550007135091859 % MOD,
        16002276252647722320 % MOD,
        4729924423368391595 % MOD,
        10059693067827680263 % MOD,
        9804807372516189948 % MOD,
        15666751576116384237 % MOD,
        10150587679474953119 % MOD,
        13627942357577414247 % MOD,
        2323786301545403792 % MOD,
        615170742765998613 % MOD,
        8870655212817778103 % MOD,
        10534167191270683080 % MOD,
    },
    {
        14572151513649018290 % MOD,
        9445470642301863087 % MOD,
        6565801926598404534 % MOD,
        12667566692985038975 % MOD,
        7193782419267459720 % MOD,
        11874811971940314298 % MOD,
        17906868010477466257 % MOD,
        1237247437760523561 % MOD,
        6829882458376718831 % MOD,
        2140011966759485221 % MOD,
        1624379354686052121 % MOD,
        50954653459374206 % MOD,
    },
    {
        16288075653722020941 % MOD,
        13294924199301620952 % MOD,
        13370596140726871456 % MOD,
        611533288599636281 % MOD,
        12865221627554828747 % MOD,
        12269498015480242943 % MOD,
        8230863118714645896 % MOD,
        13466591048726906480 % MOD,
        10176988631229240256 % MOD,
        14951460136371189405 % MOD,
        5882405912332577353 % MOD,
        18125144098115032453 % MOD,
    },
    {
        6076976409066920174 % MOD,
        7466617867456719866 % MOD,
        5509452692963105675 % MOD,
        14692460717212261752 % MOD,
        12980373618703329746 % MOD,
        1361187191725412610 % MOD,
        6093955025012408881 % MOD,
        5110883082899748359 % MOD,
        8578179704817414083 % MOD,
        9311749071195681469 % MOD,
        16965242536774914613 % MOD,
        5747454353875601040 % MOD,
    },
    {
        13684212076160345083 % MOD,
        19445754899749561 % MOD,
        16618768069125744845 % MOD,
        278225951958825090 % MOD,
        4997246680116830377 % MOD,
        782614868534172852 % MOD,
        16423767594935000044 % MOD,
        9990984633405879434 % MOD,
        16757120847103156641 % MOD,
        2103861168279461168 % MOD,
        16018697163142305052 % MOD,
        6479823382130993799 % MOD,
    },
    {
        13957683526597936825 % MOD,
        9702819874074407511 % MOD,
        18357323897135139931 % MOD,
        3029452444431245019 % MOD,
        1809322684009991117 % MOD,
        12459356450895788575 % MOD,
        11985094908667810946 % MOD,
        12868806590346066108 % MOD,
        7872185587893926881 % MOD,
        10694372443883124306 % MOD,
        8644995046789277522 % MOD,
        1422920069067375692 % MOD,
    },
    {
        17619517835351328008 % MOD,
        6173683530634627901 % MOD,
        15061027706054897896 % MOD,
        4503753322633415655 % MOD,
        11538516425871008333 % MOD,
        12777459872202073891 % MOD,
        17842814708228807409 % MOD,
        13441695826912633916 % MOD,
        5950710620243434509 % MOD,
        17040450522225825296 % MOD,
        8787650312632423701 % MOD,
        7431110942091427450 % MOD,
    }};

inline constexpr uint64_t ARK2[NUM_ROUNDS][STATE_WIDTH] = {
    {
        7989257206380839449 % MOD,
        8639509123020237648 % MOD,
        6488561830509603695 % MOD,
        5519169995467998761 % MOD,
        2972173318556248829 % MOD,
        14899875358187389787 % MOD,
        14160104549881494022 % MOD,
        5969738169680657501 % MOD,
        5116050734813646528 % MOD,
        12120002089437618419 % MOD,
        17404470791907152876 % MOD,
        2718166276419445724 % MOD,
    },
    {
        2485377440770793394 % MOD,
        14358936485713564605 % MOD,
        3327012975585973824 % MOD,
        6001912612374303716 % MOD,
        17419159457659073951 % MOD,
        11810720562576658327 % MOD,
        14802512641816370470 % MOD,
        751963320628219432 % MOD,
        9410455736958787393 % MOD,
        16405548341306967018 % MOD,
        6867376949398252373 % MOD,
        13982182448213113532 % MOD,
    },
    {
        10436926105997283389 % MOD,
        13237521312283579132 % MOD,
        668335841375552722 % MOD,
        2385521647573044240 % MOD,
        3874694023045931809 % MOD,
        12952434030222726182 % MOD,
        1972984540857058687 % MOD,
        14000313505684510403 % MOD,
        976377933822676506 % MOD,
        8407002393718726702 % MOD,
        338785660775650958 % MOD,
        4208211193539481671 % MOD,
    },
    {
        2284392243703840734 % MOD,
        4500504737691218932 % MOD,
        3976085877224857941 % MOD,
        2603294837319327956 % MOD,
        5760259105023371034 % MOD,
        2911579958858769248 % MOD,
        18415938932239013434 % MOD,
        7063156700464743997 % MOD,
        16626114991069403630 % MOD,
        163485390956217960 % MOD,
        11596043559919659130 % MOD,
        2976841507452846995 % MOD,
    },
    {
        15090073748392700862 % MOD,
        3496786927732034743 % MOD,
        8646735362535504000 % MOD,
        2460088694130347125 % MOD,
        3944675034557577794 % MOD,
        14781700518249159275 % MOD,
        2857749437648203959 % MOD,
        8505429584078195973 % MOD,
        18008150643764164736 % MOD,
        720176627102578275 % MOD,
        7038653538629322181 % MOD,
        8849746187975356582 % MOD,
    },
    {
        17427790390280348710 % MOD,
        1159544160012040055 % MOD,
        17946663256456930598 % MOD,
        6338793524502945410 % MOD,
        17715539080731926288 % MOD,
        4208940652334891422 % MOD,
        12386490721239135719 % MOD,
        10010817080957769535 % MOD,
        5566101162185411405 % MOD,
        12520146553271266365 % MOD,
        4972547404153988943 % MOD,
        5597076522138709717 % MOD,
    },
    {
        18338863478027005376 % MOD,
        115128380230345639 % MOD,
        4427489889653730058 % MOD,
        10890727269603281956 % MOD,
        7094492770210294530 % MOD,
        7345573238864544283 % MOD,
        6834103517673002336 % MOD,
        14002814950696095900 % MOD,
        15939230865809555943 % MOD,
        12717309295554119359 % MOD,
        4130723396860574906 % MOD,
        7706153020203677238 % MOD,
    }};
